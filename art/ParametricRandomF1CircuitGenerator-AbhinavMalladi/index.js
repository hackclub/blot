/*
@title: Parametric Random F1 Circuit Generator
@author: Abhinav Malladi
@snapshot: Track.png
*/

//parametric variables
const width = 210; //doc width
const height = 297; //doc height
const control_points_amount = 34; //track curve control point no. ALREADY TUNED TO RECOMMENDED SETTINGS
const nurbs_curve_degree = 20; //track curve degree ALREADY TUNED TO RECOMMENDED SETTINGS

const use_random_race_year = true; //MAKE FALSE TO SET CUSTOM RACE YEAR (DO IN VARIABLE BELOW)
let race_year_num = 2025; //year for race to be labelled as (ONLY USED IF use_random_race_year IS false)

const use_random_race_name = true; //MAKE FALSE TO SET CUSTOM RACE NAME AND COUNTRY (DO IN CONSTANTS BELOW)
const custom_race_name = "ShutBaton Sprint"; //name for race to be labelled as (ONLY USED IF use_random_track_name IS false)
const custom_country_name = "Shutland"; //country for race to be labelled as (ONLY USED IF use_random_track_name IS false)

//do race year calculations
if(use_random_race_year){
  race_year_num = bt.randIntInRange(2026, 2036);
}

//convert race_year_num to string for text engine
const race_year = race_year_num.toString();

//find midpoint of page
const midx = width/2;
const midy = height/2;

//set page size
setDocDimensions(width, height);




//list of City-Country pairs
const cities_and_countries = [
  ["Banjul", "Gambia"],
  ["Vientiane", "Laos"],
  ["Yamoussoukro", "Ivory Coast"],
  ["Tbilisi", "Georgia"],
  ["Malabo", "Equatorial Guinea"],
  ["Funafuti", "Tuvalu"],
  ["Lima", "Peru"],
  ["Port Moresby", "Papua New Guinea"],
  ["Djibouti", "Djibouti"],
  ["Bujumbura", "Burundi"],
  ["Helsinki", "Finland"],
  ["Gaborone", "Botswana"],
  ["Thimphu", "Bhutan"],
  ["San Salvador", "El Salvador"],
  ["Ngerulmud", "Palau"],
  ["Ulaanbaatar", "Mongolia"],
  ["Kampala", "Uganda"],
  ["Libreville", "Gabon"],
  ["Kingston", "Jamaica"],
  ["Juba", "South Sudan"],
  ["Yerevan", "Armenia"],
  ["Ouagadougou", "Burkina Faso"],
  ["Port Vila", "Vanuatu"],
  ["Kigali", "Rwanda"],
  ["Lome", "Togo"],
  ["Belmopan", "Belize"],
  ["Honiara", "Solomon Islands"],
  ["Windhoek", "Namibia"],
  ["Palikir", "Micronesia"],
  ["Papeete", "French Polynesia"],
  ["Gitega", "Burundi"],
  ["Nouakchott", "Mauritania"],
  ["Baku", "Azerbaijan"],
  ["Nairobi", "Kenya"],
  ["Tunis", "Tunisia"],
  ["Luanda", "Angola"],
  ["Sana'a", "Yemen"],
  ["Dili", "Timor-Leste"],
  ["Bern", "Switzerland"],
  ["Avarua", "Cook Islands"],
  ["Tashkent", "Uzbekistan"],
  ["Victoria", "Seychelles"],
  ["Palmas", "Brazil"],
  ["Tegucigalpa", "Honduras"],
  ["Minsk", "Belarus"],
  ["Riga", "Latvia"],
  ["Andorra la Vella", "Andorra"],
  ["Kabul", "Afghanistan"],
  ["Mogadishu", "Somalia"],
  ["Sofia", "Bulgaria"],
  ["Bucharest", "Romania"],
  ["Monrovia", "Liberia"],
  ["Kinshasa", "Democratic Republic of the Congo"],
  ["Bangui", "Central African Republic"],
  ["Pristina", "Kosovo"],
  ["Santo Domingo", "Dominican Republic"],
  ["Manama", "Bahrain"],
  ["Vatican City", "Vatican City"],
  ["Astana", "Kazakhstan"],
  ["Maputo", "Mozambique"],
  ["Zagreb", "Croatia"],
  ["Vaduz", "Liechtenstein"],
  ["Addis Ababa", "Ethiopia"],
  ["Islamabad", "Pakistan"],
  ["Oslo", "Norway"],
  ["Georgetown", "Guyana"],
  ["Abuja", "Nigeria"],
  ["Cotonou", "Benin"],
  ["Freetown", "Sierra Leone"],
  ["Antananarivo", "Madagascar"],
  ["Tarawa", "Kiribati"],
  ["Panama City", "Panama"],
  ["Dhaka", "Bangladesh"],
  ["Bratislava", "Slovakia"],
  ["Saint John's", "Antigua and Barbuda"],
  ["Cairo", "Egypt"],
  ["Prague", "Czech Republic"],
  ["Chisinau", "Moldova"],
  ["Suva", "Fiji"],
  ["San Salvador", "El Salvador"]
];

//List of Grand-Prix Race Name Suffixes
const circuit_names = [
  "GP Circuit",
  "Int. Circuit",
  "Raceway",
  "Circuit", 
  "Speedway",
  "Grand",
  "Hill",
  "Ring",
  "Sprint"
];

//generate track name
const location_index = bt.randIntInRange(0, cities_and_countries.length-1);
const suffix_index = bt.randIntInRange(0, circuit_names.length-1);
let track = {};

if(use_random_race_name){
  track = {
    name:`${cities_and_countries[location_index][0]} ${circuit_names[suffix_index]}`,
    country:cities_and_countries[location_index][1],
    year:race_year,
  };
}
else{
  track = {
    name:custom_race_name.toString(),
    country:custom_country_name.toString(),
    year:race_year,
  };
}




//Text Engine in Scott C's and in geschmit's submissions
//https://github.com/geschmit/blotfont
// ============================ Text Engine ============================
// instructions.ts
var ParseCoords = (cstr, multScale = 1) => {
  const coordArray = [];
  for (const x of cstr.split(":")) {
    if (parseFloat(x)) {
      coordArray.push(parseFloat(x));
    }
  }
  return coordArray;
};
var RunInstructions = (inst, org, scale = 1) => {
  const turtle = new bt.Turtle();
  turtle.jump(org);
  for (const x of inst.split(",")) {
    const cmd = x.split("$")[0];
    const args = x.split("$")[1];
    let data;
    switch (cmd) {
      case "u":
        turtle.up();
        break;
      case "d":
        turtle.down();
        break;
      case "f":
        turtle.forward(parseFloat(args) * scale);
        break;
      case "arc":
        data = ParseCoords(args);
        turtle.arc(-data[0], data[1] * scale);
        break;
      case "jmp":
        data = ParseCoords(args);
        turtle.jump(data);
        break;
      case "sa":
        turtle.setAngle(parseFloat(args));
        break;
      case "l":
        turtle.left(parseFloat(args));
        break;
      case "r":
        turtle.right(parseFloat(args));
        break;
      default:
        break;
    }
  }
  drawLines(turtle.lines());
  return turtle.position;
};

// letters.ts
var letters = {
  // some of these instructions could definitely be minified. I will most
  // likely submit a second pr to fix some of these later
  // todo unterrible letter instructions
  a: `sa$90,f$2,r$90,f$2,r$90,f$2,u,sa$90,f$2,d,l$30,f$2,l$120,f$2`,
  b: `sa$90,f$4,r$90,f$1,arc$180:1,f$1,r$180,f$1,arc$180:1,f$1`,
  c: `sa$90,u,r$90,f$2,r$180,d,arc$180:2`,
  d: `sa$90,f$4,r$90,arc$180:2`,
  e: `sa$90,f$4,r$90,f$2,u,f$-2,r$90,f$2,l$90,d,f$2,u,f$-2,r$90,f$2,l$90,d,f$2`,
  f: `sa$90,f$4,r$90,f$2,u,f$-2,r$90,f$2,l$90,d,f$2`,
  g: `u,f$1,sa$90,f$2,r$90,d,arc$270:1,f$2,arc$90:1`,
  h: `sa$90,f$4,u,f$-2,r$90,d,f$2,u,l$90,f$-2,d,f$4`,
  i: `f$2,u,f$-1,l$90,d,f$4,r$90,u,f$-1,d,f$2`,
  j: `sa$90,u,f$4,r$90,d,f$2,u,f$-1,r$90,d,f$3,arc$90:1`,
  k: `sa$90,f$4,u,f$-2,r$45,d,f$2.75,u,f$-2.75,r$90,d,f$2.75`,
  l: `sa$90,u,f$4,r$180,d,f$4,l$90,f$2`,
  m: `sa$90,f$4,sa$0,r$71.57,f$3.162,sa$0,l$71.57,f$3.162,sa$0,r$90,f$4`,
  n: `sa$90,f$4,r$153.43,f$4.47,l$153.43,f$4`,
  o: `sa$90,u,f$1,d,f$2,arc$180:1,f$2,arc$180:1`,
  p: `sa$90,f$4,r$90,f$1,arc$180:1,f$1`,
  q: `sa$90,u,f$1,d,f$2,arc$180:1,f$2,arc$180:1,u,r$90,f$1,r$45,d,f$1.414`,
  r: `sa$90,f$4,r$90,f$1,arc$180:1,f$1,sa$-45,f$2.8284`,
  s: `f$1,arc$-180:1,arc$180:1,f$1`,
  t: `u,f$1,sa$90,d,f$4,u,r$90,f$-1,d,f$2`,
  u: `sa$90,u,f$4,sa$-90,d,f$3,arc$-180:1,f$3`,
  v: `sa$90,u,f$4,r$165.96,d,f$4.12,l$151.93,f$4.12`,
  w: `sa$90,u,f$4,sa$0,r$82.87,d,f$4.03,sa$0,l$63.43,f$1.12,sa$0,r$63.43,f$1.12,sa$0,l$82.87,f$4.03`,
  x: `sa$90,u,f$4,r$153.44,d,f$4.47,u,l$153.44,f$4,l$153.44,d,f$4.47`,
  y: `u,f$1,sa$90,d,f$2.5,r$33.69,f$1.8,u,f$-1.8,l$67.38,d,f$1.8`,
  z: `u,f$2,d,f$-2,l$63.44,f$4.47,r$63.44,f$-2`,
  ["0"]: `sa$90,u,f$1,d,f$2,arc$180:1,f$2,arc$180:1,u,f$2,arc$45:1,sa$-66.80,d,f$3.675`,
  ["1"]: (origin, scale) => DrawBezier(
    origin,
    -106,
    scale,
    bezierEasing(0.026, [0.984, -1], [1, 1], 0.9561),
    [2, -0.47],
    `f$2,u,f$-1,sa$90,d,f$4,l$90`
  ),
  ["2"]: `u,f$2,r$180,d,f$2,sa$90,arc$90:1,arc$-90:1,f$1,arc$-180:1`,
  ["3"]: `sa$90,u,f$4,r$90,d,f$1,arc$180:1,f$1,r$180,f$1,arc$180:1,f$1`,
  ["4"]: `u,f$2,sa$90,f$1,l$90,d,f$2,r$116.57,f$3.35,sa$-90,f$4`,
  ["5"]: `u,sa$90,f$1,r$180,d,arc$-180:1,f$1,arc$-90:1,arc$90:1,sa$0,f$2`,
  ["6"]: (origin, scale) => DrawBezier(
    origin,
    74,
    scale,
    bezierEasing(-0.018, [0.054, -0.373], [1, -0.758], 0.9181),
    [3.2, -0.36],
    `u,sa$90,f$1,d,arc$360:1`
  ),
  ["7"]: (origin, scale) => DrawBezier(
    origin,
    245,
    scale,
    bezierEasing(-5e-3, [0, -0.149], [0, 1], 0.206),
    [4.5, -0.59],
    `u,sa$90,f$4,r$90,d,f$2`
  ),
  ["8"]: `u,f$1,d,arc$-180:1,arc$360:1,arc$-180:1`,
  ["9"]: (origin, scale) => DrawBezier(
    origin,
    -107,
    scale,
    bezierEasing(-0.018, [0.054, -0.373], [1, -0.758], 0.9181),
    [3.2, -0.36],
    `u,sa$90,f$4,r$90,f$1,d,arc$360:1,u,arc$90:1,d`
  ),
  ["."]: `sa$90,u,f$.75,r$90,f$1,d,arc$360:.25`,
  [","]: `sa$90,u,f$.5,r$90,f$1,r$90,d,arc$90:.25`,
  ["?"]: `sa$90,u,f$.75,r$90,f$1,d,arc$360:.25,l$90,u,f$.25,d,f$1,r$90,arc$-270:1`,
  ["!"]: `sa$90,u,f$.75,r$90,f$1,d,arc$360:.25,l$90,u,f$.25,d,f$3`,
  ["+"]: `sa$90,u,f$2,r$90,d,f$2,u,f$-1,l$90,f$-1,d,f$2`,
  ["-"]: `sa$90,u,f$2,r$90,d,f$2`,
  ["*"]: `sa$90,u,f$2,r$90,f$1,l$90,f$-1,d,f$2,u,f$-1,r$60,f$-1,d,f$2,u,f$-1,r$60,f$-1,d,f$2`,
  ["/"]: `l$63.43,f$4.47`,
  ["="]: `sa$90,u,f$1.5,r$90,d,f$2,u,l$90,f$1,l$90,d,f$2`,
  ["$"]: `f$1,arc$-180:1,arc$180:1,f$1,u,f$-1,r$90,d,f$4`,
  [":"]: `sa$90,u,f$.75,r$90,f$1,d,arc$360:.25,l$90,u,f$2.5,d,r$90,arc$360:.25`,
  [";"]: `sa$90,u,f$.25,r$90,f$1,r$90,d,arc$90:.25,u,arc$270:.25,r$180,f$3,d,r$90,arc$-360:.25`,
  ["("]: `u,f$1.25,r$180,d,arc$90:.5,f$3,arc$90:.5`,
  [")"]: `u,f$.75,d,arc$-90:.5,f$3,arc$-90:.5`,
  ["["]: `u,f$1.5,r$180,d,f$1,r$90,f$4,r$90,f$1`,
  ["]"]: `u,f$.5,d,f$1,l$90,f$4,l$90,f$1`,
  ["#"]: `sa$90,u,f$1.5,r$90,d,f$2,u,l$90,f$1,l$90,d,f$2,u,r$90,f$.5,r$90,f$.5,r$90,d,f$2,u,l$90,f$1,l$90,d,f$2`,
  ["%"]: `sa$90,u,f$2,r$45,d,f$2.83,u,l$45,f$-1.5,d,arc$-360:.5,u,f$1.5,l$90,f$1.5,d,arc$-360:.5`,
  ["_"]: `f$2`,
  ["|"]: `u,f$1,sa$90,d,f$4`,
  ["\\"]: `u,f$4,r$153.43,d,f$4.47`,
  ['"']: `u,f$.5,sa$90,f$3,d,f$1,u,r$90,f$1,r$90,f$1`,
  ["'"]: `u,f$1,sa$90,f$3,d,f$1`,
  [">"]: `sa$90,u,f$1,r$63.43,d,f$2.24,l$127,f$2.24`,
  // redo
  ["<"]: `u,f$2,sa$90,f$1,l$63.43,d,f$2.24,r$127,f$2.24`,
  // specials
  [" "]: ``,
  ["\r"]: ``,
  ["\n"]: ``
};
var allLetters = Object.keys(letters).join("");

// funcs.ts
var DrawBezier = (org, ang, scale, bezfunc, curveSizes, instructions) => {
  const turtle = new bt.Turtle();
  turtle.jump(org);
  if (instructions) {
    turtle.jump(RunInstructions(instructions, org, scale));
  }
  turtle.setAngle(ang);
  turtle.forward(curveSizes[0] * scale);
  bt.resample(turtle.path, 0.1);
  warp(turtle, (x) => bezfunc(x) * curveSizes[1] * scale);
  drawLines(turtle.lines());
  return;
};

var DrawText = (text, org, scale = 100, spacing = [2.5, 4.5]) => {
  let xInd = 0;
  let yInd = 0;
  for (const x of text.toLowerCase()) {
    if (allLetters.indexOf(x, 0) == -1) {
      RunInstructions(
        letters["?"],
        [
          org[0] + xInd * spacing[0] * scale,
          org[1] - yInd * spacing[1] * scale
        ],
        scale
      );
    } else {
      switch (x) {
        case "\r":
          xInd = 0;
          continue;
        case "\n":
          xInd = 0;
          yInd += 1;
          continue;
        default:
          if (typeof letters[x] == "string") {
            RunInstructions(
              letters[x],
              [
                org[0] + xInd * spacing[0] * scale,
                org[1] - yInd * spacing[1] * scale
              ],
              scale
            );
          } else if (typeof letters[x] == "function") {
            letters[x]([
              org[0] + xInd * spacing[0] * scale,
              org[1] - yInd * spacing[1] * scale
            ], scale);
          }
          break;
      }
      xInd += 1;
      continue;
    }
  }
  return;
};

// ========================== Text Engine End ==========================
//Text Engine in Scott C's and in geschmit's submissions
//https://github.com/geschmit/blotfont




//F1 Polyline DO NOT EDIT VALUES!
//By Liberty Media - https://www.formula1.com/, Public Domain, https://commons.wikimedia.org/w/index.php?curid=145228957
//Registered trademark symbol removed due to small size
const F1_width = 320;
const F1_height = 80;
const F1 = [[[45.25830078125,0],[80.74169921875,34.42499923706055],[80.7332992553711,34.42499923706055],[82.02079685684294,35.66268688533455],[83.26497896760702,36.834721103310585],[84.47121035773307,37.94283068086952],[85.6448557972908,38.98874440789223],[86.79128005634993,39.97419107425958],[87.91584790498018,40.90089946985245],[89.02392411325127,41.770598384551704],[90.12087345123291,42.58501660823822],[91.21206068899482,43.34588293079287],[92.30285059660673,44.05492614209652],[93.39860794413835,44.713875032030046],[94.5046975016594,45.32445839047432],[95.62648403923959,45.88840500731021],[96.76933232694864,46.407443672418594],[97.93860713485628,46.88330317568034],[99.13967323303223,47.31771230697632],[100.37789539154619,47.7123998561874],[101.65863838046789,48.069094613194466],[102.98726696986705,48.38952536787838],[104.36914592981339,48.67542091012001],[105.80964003037661,48.928510029800236],[107.31411404162645,49.15052151679993],[108.88793273363262,49.343184160999954],[110.53646087646484,49.50822675228119],[112.26506324019283,49.647378080524504],[114.0791045948863,49.76236693561077],[115.98394971061498,49.85492210742086],[117.98496335744858,49.92677238583565],[120.08751030545682,49.979646560736],[122.29695532470942,50.01527342200279],[124.61866318527609,50.035381759516895],[127.05799865722656,50.04170036315918],[233.4080047607422,50.04170036315918],[264.00799560546875,80],[123.0250015258789,80],[119.75279248470906,79.98961435827368],[116.62391134817153,79.95675861730706],[113.63168540399056,79.89888455341861],[110.76944193989038,79.81344394292682],[108.03050824359525,79.69788856215018],[105.4082116028294,79.54967018740717],[102.89587930531707,79.36624059501628],[100.4868386387825,79.14505156129599],[98.17441689094994,78.88355486256478],[95.95194134954363,78.57920227514114],[93.81273930228781,78.22944557534356],[91.75013803690672,77.83173653949052],[89.7574648411246,77.3835269439005],[87.8280470026657,76.882268564892],[85.95521180925425,76.32541317878349],[84.1322865486145,75.71041256189346],[82.35259850847069,75.0347184905404],[80.60947497654706,74.29578274104279],[78.89624324056786,73.4910570897191],[77.20623058825731,72.61799331288785],[75.53276430733968,71.6740431868675],[73.86917168553919,70.65665848797653],[72.20878001058009,69.56329099253344],[70.54491657018661,68.39139247685671],[68.87090865208302,67.13841471726482],[67.18008354399353,65.80180949007627],[65.4657685336424,64.37902857160952],[63.72129090875387,62.86752373818308],[61.93997795705218,61.26474676611542],[60.115156966261566,59.56814943172503],[58.240155224106275,57.7751835113304],[56.30830001831055,55.88330078125],[0,0],[45.25830078125,0]],[[127.69999694824219,45.25830078125],[228.8419952392578,45.25830078125],[200.79200744628906,17.208301544189453],[128.22500610351562,17.208301544189453],[127.00804879120551,17.206307220389135],[125.84921648912132,17.19967117253691],[124.74594279122539,17.18741378595587],[123.69566129148006,17.168555445969105],[122.69580558384769,17.14211653789971],[121.7438092622906,17.107117447070777],[120.83710592077114,17.0625785588054],[119.97312915325165,17.007520258426666],[119.14931255369447,16.940962931257673],[118.36308971606195,16.86192696262151],[117.61189423431642,16.76943273784127],[116.89315970242023,16.662500642240047],[116.20431971433572,16.540151061140932],[115.54280786402524,16.401404379867017],[114.90605774545111,16.245280983741395],[114.29150295257568,16.070801258087158],[113.6965770793613,15.876985588227399],[113.11871371977031,15.662854359485209],[112.55534646776505,15.427427957183681],[112.00390891730785,15.169726766645908],[111.46183466236107,14.888771173194982],[110.92655729688704,14.583581562153995],[110.3955104148481,14.25317831884604],[109.8661276102066,13.896581828594208],[109.33584247692488,13.512812476721592],[108.80208860896528,13.100890648551285],[108.26229960029013,12.65983672940638],[107.7139090448618,12.188671104609966],[107.1543505366426,11.686414159485139],[106.58105766959488,11.15208627935499],[105.991464037681,10.58470784954261],[105.38300323486328,9.983299255371094],[95.4000015258789,0],[53.43330001831055,0],[84.45829772949219,31.025001525878906],[85.57803885405883,32.13701485993806],[86.65661449357867,33.19122619647533],[87.69963514478877,34.18911107245367],[88.7127113044262,35.13214502483606],[89.701453469228,36.02180359058548],[90.67147213593125,36.859562306664884],[91.62837780127302,37.646896710037254],[92.57778096199036,38.38528233766556],[93.52529211482033,39.07619472651277],[94.4765217565,39.72110941354185],[95.43708038376644,40.32150193571579],[96.4125784933567,40.87884782999754],[97.40862658200786,41.39462263335008],[98.43083514645696,41.870301882736385],[99.48481468344107,42.30736111511942],[100.57617568969727,42.70727586746216],[101.7105286619626,43.07152167672757],[102.89348409697413,43.40157407987863],[104.13065249146894,43.6989086138783],[105.42764434218407,43.965000815689564],[106.79007014585659,44.201326222275384],[108.22354039922357,44.40936037059873],[109.73366559902206,44.590578797622584],[111.32605624198914,44.746457040309906],[113.00632282486185,44.87847063562367],[114.78007584437728,44.98809512052685],[116.65292579727247,45.076806031982414],[118.6304831802845,45.146078906953335],[120.71835849015042,45.19738928240258],[122.9221622236073,45.23221269529313],[125.2475048773922,45.252024682587944],[127.69999694824219,45.25830078125]],[[320,80],[239.7830047607422,0],[190.1750030517578,0],[270.17498779296875,80],[320,80]],[[267.1830139160156,2.5333023071289062],[267.340562784113,2.377204085700214],[267.5006473734975,2.2260842844843864],[267.6632662145421,2.0799414003267884],[267.8284178376198,1.9387739300727844],[267.99610077310354,1.802580370567739],[268.16631355136633,1.6713592186570168],[268.33905470278114,1.5451089711859822],[268.51432275772095,1.423828125],[268.6921162465587,1.3075151769444346],[268.87243369966745,1.1961686238646507],[269.0552736474201,1.0897869626060128],[269.24063462018967,0.9883686900138855],[269.4285151483491,0.8919123029336333],[269.6189137622714,0.8004162982106209],[269.81182899232954,0.7138791726902127],[270.0072593688965,0.6322994232177734],[270.2052034223452,0.5556755466386676],[270.4056596830487,0.48400603979825974],[270.60862668138,0.41728939954191446],[270.81410294771194,0.35552412271499634],[271.0220870124176,0.29870870616286993],[271.23257740586996,0.2468416467308998],[271.44557265844196,0.19992144126445055],[271.6610713005066,0.15794658660888672],[271.87907186243683,0.12091557960957289],[272.09957287460566,0.08882691711187363],[272.32257286738604,0.06167909596115351],[272.54807037115097,0.0394706130027771],[272.7760639162734,0.022199965082108974],[273.00655203312635,0.009865649044513702],[273.23953325208277,0.002466161735355854],[273.4750061035156,0],[273.71040649339557,0.002465655095875263],[273.943173378706,0.009861595928668976],[274.17330986633897,0.022186285816133022],[274.40081906318665,0.03943818807601929],[274.6257040761411,0.061615766026079655],[274.8479680120945,0.08871748298406601],[275.0676139779389,0.12074180226773024],[275.2846450805664,0.15768718719482422],[275.49906442686915,0.19955210108309984],[275.71087512373924,0.246335007250309],[275.9200802780688,0.29803436901420355],[276.1266829967499,0.3546486496925354],[276.33068638667464,0.41617631260305643],[276.5320935547352,0.4826158210635185],[276.7309076078236,0.5539656383916736],[276.92713165283203,0.6302242279052734],[277.12076879665256,0.71139005292207],[277.3118221461773,0.7974615767598152],[277.50029480829835,0.8884372627362609],[277.68618988990784,0.9843155741691589],[277.86951049789786,1.0850949743762612],[278.05025973916054,1.1907739266753197],[278.22844072058797,1.3013508943840861],[278.40405654907227,1.4168243408203125],[278.57711033150554,1.5371927293017507],[278.7476051747799,1.6624545231461525],[278.91554418578744,1.79260818567127],[279.0809304714203,1.9276521801948547],[279.24376713857055,2.067584970034659],[279.4040572941303,2.2124050185084343],[279.56180404499173,2.362110788933933],[279.7170104980469,2.5167007446289062],[279.8684395607561,2.6749038817360997],[280.0150417536497,2.835449196398258],[280.1568183619529,2.9983351519331336],[280.2937706708908,3.163560211658478],[280.4258999656886,3.3311228388920426],[280.5532075315714,3.50102149695158],[280.67569465376437,3.673254649154842],[280.7933626174927,3.84782075881958],[280.90621270798147,4.0247182892635465],[281.0142462104559,4.203945703804493],[281.1174644101411,4.385501465760171],[281.21586859226227,4.569384038448334],[281.3094600420445,4.755591885186732],[281.398240044713,4.9441234692931175],[281.4822098854929,5.134977254085243],[281.5613708496094,5.328151702880859],[281.63572422228754,5.523645278997719],[281.70527128875256,5.721456445753574],[281.7700133342296,5.9215836664661765],[281.8299516439438,6.124025404453278],[281.8850875031203,6.3287801230326295],[281.9354221969843,6.535846285521984],[281.9809570107609,6.745222355239093],[282.0216932296753,6.956906795501709],[282.0576321389526,7.170898069627583],[282.088775023818,7.387194640934467],[282.11512316949666,7.605794972740114],[282.1366778612137,7.826697528362274],[282.15344038419425,8.0499007711187],[282.1654120236635,8.275403164327145],[282.17259406484663,8.503203171305358],[282.17498779296875,8.733299255371094],[282.1725708534941,8.963404881535098],[282.1653200313449,9.19121696613729],[282.15323532093316,9.416737044462934],[282.136316716671,9.639966651797295],[282.11456421297044,9.860907323425636],[282.08797780424356,10.079560594633222],[282.05655748490244,10.295928000705317],[282.02030324935913,10.510011076927185],[281.9792150920257,10.721811358584091],[281.9332930073142,10.931330380961299],[281.8825369896367,11.138569679344073],[281.8269470334053,11.343530789017677],[281.766523133032,11.546215245267376],[281.70126528292894,11.746624583378434],[281.6311734775081,11.944760338636115],[281.55624771118164,12.140624046325684],[281.47648797836155,12.334217241732404],[281.3918942734599,12.52554146014154],[281.3024665908888,12.714598236838356],[281.2082049250603,12.901389107108116],[281.1091092703864,13.085915606236085],[281.00517962127924,13.268179269507527],[280.89641597215086,13.448181632207707],[280.78281831741333,13.625924229621887],[280.6643866514787,13.801408597035334],[280.54112096875906,13.97463626973331],[280.41302126366645,14.14560878300108],[280.28008753061295,14.314327672123909],[280.1423197640106,14.48079447238706],[279.9997179582715,14.645010719075799],[279.8522821078077,14.806977947475389],[279.70001220703125,14.966697692871094],[279.5440537240356,15.122795578674413],[279.38555674254894,15.273915086872876],[279.22451959736645,15.42005771852564],[279.0609406232834,15.561224974691868],[278.894818155095,15.697418356430717],[278.7261505275965,15.828639364801347],[278.5549360755831,15.954889500862919],[278.3811731338501,16.07617026567459],[278.2048600371927,16.192483160295524],[278.02599512040615,16.303829685784876],[277.8445767182857,16.41021134320181],[277.6606031656265,16.51162963360548],[277.4740727972239,16.60808605805505],[277.2849839478731,16.69958211760968],[277.09333495236933,16.786119313328527],[276.8991241455078,16.867699146270752],[276.7023498620838,16.944323117495514],[276.5030104368925,17.015992728061974],[276.3011042047292,17.08270947902929],[276.0966295003891,17.144474871456623],[275.88958465866745,17.201290406403132],[275.6799680143595,17.253157584927976],[275.4677779022604,17.300077908090316],[275.2530126571655,17.34205287694931],[275.03567061387,17.37908399256412],[274.81575010716915,17.411172755993903],[274.59324947185814,17.43832066829782],[274.36816704273224,17.46052923053503],[274.1405011545867,17.477799943764694],[273.9102501422167,17.49013430904597],[273.6774123404175,17.49753382743802],[273.4419860839844,17.5],[273.20653653051704,17.4975343340775],[272.97362434118986,17.490138362161815],[272.74324968922883,17.47781362303067],[272.51541274785995,17.460561655461788],[272.2901136903092,17.438383998232894],[272.06735268980265,17.41128219012171],[271.8471299195662,17.379257769905962],[271.6294455528259,17.342312276363373],[271.4142997628078,17.300447248271666],[271.2016927227378,17.253664224408567],[270.99162460584193,17.201964743551798],[270.7840955853462,17.145350344479084],[270.57910583447665,17.08382256596815],[270.3766555264592,17.017382946796715],[270.1767448345199,16.94603302574251],[269.97937393188477,16.869774341583252],[269.78454299177974,16.78860843309667],[269.59225218743086,16.702536839060485],[269.4025016920641,16.611561098252423],[269.2152916789055,16.515682749450207],[269.030622321181,16.41490333143156],[268.84849379211664,16.309224382974207],[268.6689062649384,16.198647442855872],[268.4918599128723,16.08317404985428],[268.31735490914434,15.96280574274715],[268.1453914269805,15.837544060312212],[267.9759696396068,15.707390541327186],[267.8090897202492,15.572346724569798],[267.6447518421337,15.43241414881777],[267.48295617848635,15.287594352848828],[267.3237029025331,15.137888875440694],[267.1669921875,14.983299255371094],[267.013881361112,14.8250961182639],[266.8656115978956,14.664550803601742],[266.722184183076,14.501664848066866],[266.58360040187836,14.336439788341522],[266.4498615395278,14.168877161107957],[266.3209688812494,13.99897850304842],[266.1969237122685,13.826745350845158],[266.07772731781006,13.65217924118042],[265.96338098309934,13.475281710736454],[265.8538859933615,13.296054296195507],[265.7492436338216,13.114498534239829],[265.6494551897049,12.930615961551666],[265.5545219462365,12.744408114813268],[265.46444518864155,12.555876530706882],[265.3792262021452,12.365022745914757],[265.29886627197266,12.17184829711914],[265.223366683349,11.97635472100228],[265.15272872149944,11.778543554246426],[265.0869536716491,11.578416333533823],[265.02604281902313,11.375974595546722],[264.9699974488467,11.17121987696737],[264.91881884634495,10.964153714478016],[264.87250829674304,10.754777644760907],[264.8310670852661,10.543093204498291],[264.79449649713933,10.329101930372417],[264.76279781758785,10.112805359065533],[264.7359723318368,9.894205027259886],[264.7140213251114,9.673302471637726],[264.6969460826367,9.4500992288813],[264.68474788963795,9.224596835672855],[264.67742803134024,8.996796828694642],[264.67498779296875,8.766700744628906],[264.6774285202846,8.536595118464902],[264.68475180119276,8.30878303386271],[264.6969592841342,8.083262955537066],[264.7140526175499,7.860033348202705],[264.7360334498808,7.639092676574364],[264.7629034295678,7.420439405366778],[264.79466420505196,7.204071999294683],[264.83131742477417,6.989988923072815],[264.8728647371754,6.778188641415909],[264.9193077906966,6.568669619038701],[264.9706482337788,6.361430320655927],[265.0268877148628,6.156469210982323],[265.0880278823897,5.953784754732624],[265.15407038480043,5.753375416621566],[265.2250168705359,5.555239661363885],[265.3008689880371,5.359375953674316],[265.381628385745,5.165782758267596],[265.4672967121005,4.97445853985846],[265.5578756155446,4.785401763161644],[265.6533667445183,4.598610892891884],[265.75377174746245,4.414084393763915],[265.8590922728181,4.231820730492473],[265.96932996902615,4.051818367792293],[266.0844864845276,3.874075770378113],[266.20456346776336,3.6985914029646665],[266.32956256717443,3.5253637302666903],[266.45948543120176,3.35439121699892],[266.5943337082863,3.185672327876091],[266.734109046869,3.0192055276129395],[266.8788130953908,2.854989280924201],[267.0284475022927,2.6930220525246114],[267.1830139160156,2.5333023071289062]],[[268.2250061035156,13.974998474121094],[268.35723116993904,14.107271273620427],[268.49140763282776,14.23534519225359],[268.6275356709957,14.359220213256776],[268.76561546325684,14.47889631986618],[268.90564718842506,14.594373495317996],[269.04763102531433,14.705651722848415],[269.19156715273857,14.812730985693634],[269.3374557495117,14.915611267089844],[269.4852969944477,15.01429255027324],[269.6350910663605,15.108774818480015],[269.78683814406395,15.199058054946363],[269.94053840637207,15.285142242908478],[270.09619203209877,15.367027365602553],[270.253799200058,15.444713406264782],[270.41336008906364,15.518200348131359],[270.5748748779297,15.587488174438477],[270.73834374547005,15.65257686842233],[270.90376687049866,15.71346641331911],[271.07114443182945,15.770156792365015],[271.24047660827637,15.822647988796234],[271.41176357865334,15.870939985848963],[271.5850055217743,15.915032766759396],[271.76020261645317,15.954926314763725],[271.9373550415039,15.990620613098145],[272.11646297574043,16.02211564499885],[272.2975265979767,16.04941139370203],[272.4805460870266,16.072507842443883],[272.6655216217041,16.091404974460602],[272.85245338082314,16.10610277298838],[273.04134154319763,16.11660122126341],[273.2321862876415,16.122900302521884],[273.42498779296875,16.125],[273.6185182342306,16.122900302521884],[273.8100448921323,16.11660122126341],[273.99956795107573,16.10610277298838],[274.1870875954628,16.091404974460602],[274.37260400969535,16.072507842443883],[274.55611737817526,16.04941139370203],[274.7376278853044,16.02211564499885],[274.9171357154846,15.990620613098145],[275.0946410531178,15.954926314763725],[275.27014408260584,15.915032766759396],[275.44364498835057,15.870939985848963],[275.6151439547539,15.822647988796234],[275.7846411662176,15.770156792365015],[275.9521368071437,15.71346641331911],[276.11763106193393,15.65257686842233],[276.28112411499023,15.587488174438477],[276.44261615071446,15.518200348131359],[276.6021073535085,15.444713406264782],[276.75959790777415,15.367027365602553],[276.91508799791336,15.285142242908478],[277.068577808328,15.199058054946363],[277.22006752341986,15.108774818480015],[277.3695573275909,15.01429255027324],[277.5170474052429,14.915611267089844],[277.66253794077784,14.812730985693634],[277.8060291185975,14.705651722848415],[277.9475211231038,14.594373495317996],[278.0870141386986,14.47889631986618],[278.2245083497837,14.359220213256776],[278.3600039407611,14.23534519225359],[278.49350109603256,14.107271273620427],[278.625,13.974998474121094],[278.75347229186445,13.839723433600739],[278.87788850814104,13.702641362324357],[278.99824717920274,13.56375227845274],[279.1145468354225,13.423056200146675],[279.22678600717336,13.280553145566955],[279.33496322482824,13.13624313287437],[279.43907701876014,12.990126180229709],[279.53912591934204,12.842202305793762],[279.6351084569469,12.69247152772732],[279.7270231619477,12.540933864191175],[279.8148685647175,12.387589333346114],[279.8986431956291,12.232437953352928],[279.97834558505565,12.075479742372409],[280.05397426337004,11.916714718565345],[280.12552776094526,11.756142900092527],[280.1930046081543,11.593764305114746],[280.2564033353701,11.429578951792791],[280.3157224729657,11.263586858287454],[280.37096055131406,11.095788042759523],[280.4221161007881,10.92618252336979],[280.4691876517609,10.754770318279043],[280.5121737346053,10.581551445648074],[280.5510728796944,10.406525923637673],[280.5858836174011,10.22969377040863],[280.61660447809845,10.051055004121736],[280.64323399215937,9.87060964293778],[280.66577068995684,9.688357705017552],[280.68421310186386,9.504299208521843],[280.6985597582534,9.318434171611443],[280.7088091894984,9.130762612447143],[280.7149599259719,8.941284549189731],[280.7170104980469,8.75],[280.7149599259719,8.558739800704643],[280.7088091894984,8.369333749637008],[280.6985597582534,8.181780308717862],[280.68421310186386,7.996077939867973],[280.66577068995684,7.81222510500811],[280.64323399215937,7.630220266059041],[280.61660447809845,7.450061884941533],[280.5858836174011,7.271748423576355],[280.5510728796944,7.095278343884274],[280.5121737346053,6.920650107786059],[280.4691876517609,6.747862177202478],[280.4221161007881,6.576913014054298],[280.37096055131406,6.4078010802622885],[280.3157224729657,6.240524837747216],[280.2564033353701,6.07508274842985],[280.1930046081543,5.911473274230957],[280.12552776094526,5.749694877071306],[280.05397426337004,5.589746018871665],[279.97834558505565,5.431625161552802],[279.8986431956291,5.275330767035484],[279.8148685647175,5.120861297240481],[279.7270231619477,4.968215214088559],[279.6351084569469,4.8173909795004874],[279.53912591934204,4.668387055397034],[279.43907701876014,4.521201903698966],[279.33496322482824,4.375833986327052],[279.22678600717336,4.23228176520206],[279.1145468354225,4.090543702244759],[278.99824717920274,3.950618259375915],[278.87788850814104,3.8125038985162973],[278.75347229186445,3.676199081586674],[278.625,3.5417022705078125],[278.4927976252511,3.410207415930927],[278.3586863055825,3.2829099223017693],[278.2226614644751,3.1598082864657044],[278.0847185254097,3.040901005268097],[277.9448529118672,2.9261865755543113],[277.8030600473285,2.815663494169712],[277.6593353552744,2.709330257959664],[277.5136742591858,2.6071853637695312],[277.3660721825436,2.509227308444679],[277.2165245488286,2.415454588830471],[277.06502678152174,2.3258657017722726],[276.91157430410385,2.240459144115448],[276.7561625400558,2.159233412705362],[276.5987869128585,2.0821870043873787],[276.43944284599274,2.009318416006863],[276.27812576293945,1.9406261444091797],[276.1148310871795,1.876108686439693],[275.9495542421937,1.8157645389437675],[275.782290651463,1.759592198766768],[275.61303573846817,1.7075901627540588],[275.44178492669016,1.6597569277510047],[275.2685336396098,1.6160909906029701],[275.093277300708,1.5765908481553197],[274.9160113334656,1.541254997253418],[274.7367311613634,1.5100819347426295],[274.5554322078824,1.483070157468319],[274.3721098965034,1.4602181622758508],[274.18675965070724,1.4415244460105896],[273.99937689397484,1.4269875055179],[273.80995704978704,1.4166058376431465],[273.6184955416247,1.4103779392316937],[273.42498779296875,1.4083023071289062],[273.2314601242542,1.4104020043741912],[273.0399360656738,1.4167010840028524],[272.8504154384136,1.4271995278540999],[272.66289806365967,1.4418973177671432],[272.47738376259804,1.4607944355811924],[272.2938723564148,1.483890863135457],[272.112363666296,1.511186582269147],[271.93285751342773,1.5426815748214722],[271.75535371899605,1.5783758226316422],[271.579852104187,1.618269307538867],[271.4063524901867,1.6623620113823563],[271.23485469818115,1.7106539160013199],[271.06535854935646,1.7631450032349676],[270.8978638648987,1.8198352549225092],[270.7323704659939,1.8807246529031545],[270.5688781738281,1.9458131790161133],[270.4073868095875,2.0151008151005954],[270.247896194458,2.0885875429958105],[270.0904061496258,2.1662733445409685],[269.93491649627686,2.2481582015752792],[269.7814270555973,2.3342420959379524],[269.6299376487732,2.424525009468198],[269.4804480969906,2.5190069240052253],[269.33295822143555,2.6176878213882446],[269.18746784329414,2.7205676834564656],[269.04397678375244,2.827646492049098],[268.9024848639965,2.9389242290053517],[268.7629919052124,3.0544008761644363],[268.6254977285862,3.174076415365562],[268.49000215530396,3.297950828447938],[268.35650500655174,3.4260240972507745],[268.2250061035156,3.5582962036132812],[268.09653381165117,3.693556598154828],[267.9721175953746,3.830575754866004],[267.8517589243129,3.9693552313838154],[267.7354592680931,4.109896585345268],[267.62322009634227,4.252201374387369],[267.5150428786874,4.396271156147122],[267.4109290847555,4.542107488261536],[267.3108801841736,4.689711928367615],[267.2148976465687,4.839086034102365],[267.1229829415679,4.990231363102794],[267.03513753879815,5.143149473005906],[266.9513629078865,5.297841921448708],[266.87166051846,5.454310266068205],[266.7960318401456,5.612556064501405],[266.72447834257036,5.772580874385312],[266.6570014953613,5.934386253356934],[266.5936027681455,6.097973759053275],[266.5342836305499,6.263344949111342],[266.47904555220157,6.430501381168142],[266.4278900027275,6.59944461286068],[266.38081845175475,6.7701762018259615],[266.3378323689103,6.9426977057009935],[266.2989332238212,7.117010682122782],[266.2641224861145,7.2931166887283325],[266.2334016254172,7.4710172831546515],[266.20677211135626,7.650714023038745],[266.1842354135588,7.832208466017619],[266.16579300165176,8.01550216972828],[266.15144634526223,8.200596691807732],[266.1411969140172,8.387493589892983],[266.1350461775437,8.57619442162104],[266.13299560546875,8.766700744628906],[266.1350461775437,8.957197666866705],[266.1411969140172,9.145890271291137],[266.15144634526223,9.332780037308112],[266.16579300165176,9.51786844432354],[266.1842354135588,9.70115697174333],[266.20677211135626,9.882647098973393],[266.2334016254172,10.062340305419639],[266.2641224861145,10.240238070487976],[266.2989332238212,10.416341873584315],[266.3378323689103,10.590653194114566],[266.38081845175475,10.763173511484638],[266.4278900027275,10.933904305100441],[266.47904555220157,11.102847054367885],[266.5342836305499,11.27000323869288],[266.5936027681455,11.435374337481335],[266.6570014953613,11.59896183013916],[266.72447834257036,11.760767196072266],[266.7960318401456,11.92079191468656],[266.87166051846,12.079037465387955],[266.9513629078865,12.23550532758236],[267.03513753879815,12.390196980675682],[267.1229829415679,12.543113904073834],[267.2148976465687,12.694257577182725],[267.3108801841736,12.843629479408264],[267.4109290847555,12.991231090156361],[267.5150428786874,13.137063888832927],[267.62322009634227,13.28112935484387],[267.7354592680931,13.4234289675951],[267.8517589243129,13.563964206492528],[267.9721175953746,13.702736550942063],[268.09653381165117,13.839747480349615],[268.2250061035156,13.974998474121094]],[[271.7170104980469,3.875],[271.7170104980469,7.308296203613281],[271.7250061035156,7.3000030517578125],[273.6830139160156,7.3000030517578125],[275.3420104980469,3.86669921875],[277.36700439453125,3.86669921875],[275.5419921875,7.5500030517578125],[275.6553606018424,7.60410020314157],[275.76447266340256,7.660164162516594],[275.86933708935976,7.718206943944097],[275.9699625968933,7.7782405614852905],[276.0663579031825,7.840277029201388],[276.15853172540665,7.904328361153603],[276.24649278074503,7.970406571403146],[276.33024978637695,8.03852367401123],[276.4098114594817,8.10869168303907],[276.4851865172386,8.180922612547874],[276.55638367682695,8.255228476598859],[276.623411655426,8.331621289253235],[276.68627917021513,8.410113064572215],[276.74499493837357,8.490715816617012],[276.79956767708063,8.573441559448838],[276.8500061035156,8.658302307128906],[276.89682368934155,8.747083064168692],[276.940535902977,8.841526478528976],[276.98115445673466,8.941632527858019],[277.01869106292725,9.047401189804077],[277.05315743386745,9.15883244201541],[277.084565281868,9.275926262140274],[277.1129263192415,9.398682627826929],[277.1382522583008,9.527101516723633],[277.16055481135845,9.661182906478643],[277.17984569072723,9.80092677474022],[277.1961366087198,9.946333099156618],[277.2094392776489,10.097401857376099],[277.21976540982723,10.254133027046919],[277.22712671756744,10.416526585817337],[277.23153491318226,10.584582511335611],[277.2330017089844,10.75830078125],[277.23207583930343,10.845900784013793],[277.22929798811674,10.932131757959723],[277.2246677922085,11.016992198536173],[277.2181848883629,11.10048060119152],[277.2098489133641,11.182595461374149],[277.1996595039964,11.263335274532437],[277.18761629704386,11.342698536114767],[277.17371892929077,11.420683741569519],[277.1579670375213,11.497289386345074],[277.14036025851965,11.572513965889812],[277.12089822907,11.646355975652114],[277.0995805859566,11.71881391108036],[277.07640696596354,11.789886267622933],[277.0513770058751,11.859571540728211],[277.0244903424755,11.927868225844577],[276.9957466125488,11.99477481842041],[276.96514545287937,12.060289813904092],[276.9326865002513,12.124411707744002],[276.8983693914488,12.187138995388523],[276.8621937632561,12.248470172286034],[276.8241592524573,12.308403733884916],[276.78426549583673,12.36693817563355],[276.7425121301785,12.424071992980316],[276.69889879226685,12.479803681373596],[276.65342511888593,12.53413173626177],[276.60609074682,12.587054653093219],[276.55689531285316,12.638570927316323],[276.5058384537697,12.688679054379463],[276.45291980635375,12.73737752973102],[276.39813900738955,12.784664848819375],[276.3414956936613,12.830539507092908],[276.2829895019531,12.875],[276.22271776665,12.91882326011546],[276.16059032827616,12.961231851950288],[276.0966088240966,13.002227313583717],[276.0307748913765,13.041811183094978],[275.96309016738087,13.079984998563305],[275.8935562893748,13.116750298067927],[275.82217489462346,13.152108619688079],[275.74894762039185,13.18606150150299],[275.6738761039451,13.218610481591895],[275.59696198254824,13.249757098034024],[275.5182068934664,13.27950288890861],[275.4376124739647,13.307849392294884],[275.35518036130816,13.334798146272078],[275.2709121927619,13.360350688919425],[275.184809605591,13.384508558316156],[275.09687423706055,13.407273292541504],[275.0071077244356,13.4286464296747],[274.9155117049813,13.448629507794976],[274.82208781596273,13.467224064981565],[274.7268376946449,13.484431639313698],[274.629762978293,13.500253768870607],[274.53086530417204,13.514691991731524],[274.4301463095471,13.527747845975682],[274.32760763168335,13.539422869682312],[274.2232509078458,13.549718600930646],[274.11707777529955,13.558636577799916],[274.0090898713097,13.566178338369355],[273.8992888331413,13.572345420718193],[273.7876762980595,13.577139362925664],[273.6742539033294,13.580561703070998],[273.55902328621596,13.582613979233429],[273.4419860839844,13.583297729492188],[269.7919921875,13.583297729492188],[269.7919921875,3.875],[271.7170104980469,3.875]],[[271.6830139160156,8.816703796386719],[271.6830139160156,12.083297729492188],[273.2749938964844,12.083297729492188],[273.4018731173128,12.081710764206946],[273.5246993750334,12.076948828995228],[273.64347431249917,12.069010364823043],[273.75819957256317,12.057893812656403],[273.8688767980784,12.043597613461316],[273.9755076318979,12.026120208203793],[274.0780937168747,12.005460037849844],[274.1766366958618,11.981615543365479],[274.27113821171224,11.954585165716708],[274.361599907279,11.924367345869541],[274.44802342541516,11.890960524789989],[274.5304104089737,11.854363143444061],[274.60876250080764,11.814573642797768],[274.68308134377,11.77159046381712],[274.75336858071387,11.725412047468126],[274.8196258544922,11.676036834716797],[274.881854807958,11.623463266529143],[274.94005708396435,11.567689783871174],[274.99423432536423,11.5087148277089],[275.0443881750107,11.446536839008331],[275.0905202757567,11.381154258735478],[275.13263227045536,11.31256552785635],[275.17072580195963,11.240769087336957],[275.20480251312256,11.16576337814331],[275.23486404679716,11.08754684124142],[275.26091204583645,11.006117917597294],[275.28294815309346,10.921475048176944],[275.3009740114212,10.83361667394638],[275.3149912636727,10.742541235871613],[275.325001552701,10.648247174918652],[275.3310065213591,10.550732932053506],[275.3330078125,10.449996948242188],[275.33144902437925,10.34404006227851],[275.3267716765404,10.241793364286423],[275.3189742937684,10.14325701072812],[275.3080554008484,10.048431158065796],[275.29401352256536,9.95731596276164],[275.2768471837044,9.869911581277847],[275.25655490905046,9.786218170076609],[275.2331352233887,9.706235885620117],[275.20658665150404,9.629964884370565],[275.1769077181816,9.557405322790146],[275.1440969482064,9.488557357341051],[275.1081528663635,9.423421144485474],[275.06907399743795,9.361996840685606],[275.02685886621475,9.30428460240364],[274.98150599747896,9.25028458610177],[274.9330139160156,9.199996948242188],[274.8825856745243,9.153126986697316],[274.82806849479675,9.109368935227394],[274.7694739997387,9.068710645660758],[274.70681381225586,9.031139969825745],[274.640099555254,8.99664475955069],[274.5693428516388,8.965212866663933],[274.494555324316,8.936832142993808],[274.4157485961914,8.911490440368652],[274.33293429017067,8.889175610616803],[274.24612402915955,8.869875505566597],[274.15532943606377,8.85357797704637],[274.06056213378906,8.84027087688446],[273.96183374524117,8.829942056909204],[273.8591558933258,8.822579368948936],[273.7525402009487,8.818170664831996],[273.6419982910156,8.816703796386719],[271.6830139160156,8.816703796386719]]];

//Scale F1 logo to stay in page size
let F1_scale_width = (width*0.8)/F1_width;
let F1_scale_height = (height*0.1)/F1_height;
if(F1_scale_width < F1_scale_height){
  bt.scale(F1, F1_scale_width, [0,0]);
}
else{
  bt.scale(F1, F1_scale_height, [0,0]);
}

//Translate F1 Logo
bt.originate(F1);
bt.translate(F1, [midx,height*0.9]);




//point generation polyline
const polyline = [];

//generate random points on page
for(let i = 0; i<control_points_amount; i++){
  polyline.push([
    bt.randInRange(width*0.15, width*0.85),
    bt.randInRange(height*0.3, height*0.8)
  ]);
}

//sort the points so they run "clockwise" around the centre, by using angle from page centre
//this is done using atan2 and a custom sorting function
polyline.sort(function(a,b){
  return Math.atan2((b[1]-midy), (b[0]-midx)) - Math.atan2((a[1]-midy), (a[0]-midx));
});

//add beginning point to end to make a polygon
polyline.push([
  polyline[0][0],
  polyline[0][1]
]);




//turn lines into a curve
//make options object to be passed to the nurbs curve maker
const curve_ops = {
  degree:nurbs_curve_degree
};
const curve = [bt.nurbs(polyline, curve_ops)];

//get normal of track at start and create a polyline for it
const point = bt.getPoint(curve, 0.0);
const normal_vec = bt.getNormal(curve, 0.0);
const normal_inside = [point[0]+(normal_vec[0]*-((width+height)/160)), point[1]+(normal_vec[1]*-((width+height)/160))];
const normal_outside = [point[0]+(normal_vec[0]*((width+height)/160)), point[1]+(normal_vec[1]*((width+height)/160))];

const start_line = [[normal_inside, normal_outside]];

//create track outline from track curve
const inner_line = bt.copy(curve);
const outer_line = bt.copy(curve);
bt.offset(inner_line, -((width+height)/160));
bt.offset(outer_line, ((width+height)/160));

//create page outline
const page_outline = [[[width*0.025, height*0.025],[width*0.025, height*0.975],[width*0.975, height*0.975],[width*0.975, height*0.025],[width*0.025, height*0.025]]];

//join all polylines for drawing
const joined_polylines = bt.copy(inner_line);
bt.join(joined_polylines, outer_line, F1, start_line, page_outline);

//draw lines to page
drawLines(joined_polylines);




//render text - uses a Text Engine, part of Blot Font: https://github.com/geschmit/blotfont
//scale Track name to stay in page size, find max font size scale (1 taken to be default)
function get_text_width(text_length, scale = 1){
  return ((2.5*text_length)-0.5)*scale;
}

const max_text_char_width = Math.max(track.name.length, track.country.length, track.year.length);
const text_def_width = get_text_width(max_text_char_width);
const text_def_height = 14;
const text_scale_width = (width*0.8)/text_def_width;
const text_scale_height = (height*0.2)/text_def_height;
const font_size = Math.min(text_scale_width, text_scale_height);

const text_width = text_def_width * font_size;
const text_height = text_def_height * font_size;

//render text to page
DrawText(track.name, [midx-(get_text_width(track.name.length, font_size)/2), (height*0.15)+((3)*font_size)], font_size, [2.5, 0]);
DrawText(track.country, [midx-(get_text_width(track.country.length, font_size)/2), (height*0.15)+((-2)*font_size)], font_size, [2.5, 0]);
DrawText(track.year, [midx-(get_text_width(track.year.length, font_size)/2), (height*0.15)+((-7)*font_size)], font_size, [2.5, 0]);




//Text Engine Helper Functions in Scott C's and in geschmit's submissions
//https://github.com/geschmit/blotfont
// ==================== Text Engine Helper Functions ===================

function calculateBezierPoint(t, p0, p1, p2, p3) {
  let u = 1 - t;
  let tt = t * t;
  let uu = u * u;
  let uuu = uu * u;
  let ttt = tt * t;

  let p = [uuu * p0[0], uuu * p0[1]]; // u^3 * p0
  p[0] += 3 * uu * t * p1[0]; // 3u^2t * p1
  p[1] += 3 * uu * t * p1[1];
  p[0] += 3 * u * tt * p2[0]; // 3ut^2 * p2
  p[1] += 3 * u * tt * p2[1];
  p[0] += ttt * p3[0]; // t^3 * p3
  p[1] += ttt * p3[1];

  return p;
}

function findTForGivenX(xTarget, p0, p1, p2, p3) {
  let tolerance = 0.00001;
  let t = 0.5; // Start with approximate solution
  let iterations = 0;

  while (iterations < 1000) {
    // Max iterations to prevent infinite loop
    let p = calculateBezierPoint(t, p0, p1, p2, p3);
    let difference = p[0] - xTarget;
    if (Math.abs(difference) < tolerance) {
      return t;
    } else {
      t = t - difference / 2; // Approximate a new t value
    }
    iterations++;
  }
  return t; // Return the approximate t value
}

function getYForX(x, p0, p1, p2, p3) {
  let t = findTForGivenX(x, p0, p1, p2, p3);
  let p = calculateBezierPoint(t, p0, p1, p2, p3);
  return p[1];
}

function bezierEasing(initial, p0, p1, final) {
  return (x) =>
    getYForX(
      x,
      [0, initial],
      [Math.min(Math.max(0, p0[0]), 1), p0[1]],
      [Math.min(Math.max(0, p1[0]), 1), p1[1]],
      [1, final]
    );
}

function warp(turtle, fn, baseAngle = null) {
  const tValues = tValuesForPoints(turtle.path);
  const newPts = [];
  tValues.forEach((t, i) => {
    const pt = turtle.path.flat()[i];
    let angle = baseAngle ?? bt.getAngle(turtle.path, t);
    if (typeof angle === "function") {
      angle = angle(bt.getAngle(turtle.path, t));
    } else if (typeof angle === "number") {
      angle = angle;
    }
    const y = fn(t);
    const newPoint = rotate([0, y], angle);
    newPts.push([pt[0] + newPoint[0], pt[1] + newPoint[1]]);
  });
  turtle.path.flat().forEach((pt, i, arr) => {
    pt[0] = newPts[i][0];
    pt[1] = newPts[i][1];
  });
  return turtle

  function rotate(pt, angle, origin = [0, 0]) {
    let delta = angle / 180 * Math.PI;
    let hereX = pt[0] - origin[0];
    let hereY = pt[1] - origin[1];
    let newPoint = [
      hereX * Math.cos(delta) - hereY * Math.sin(delta) + origin[0],
      hereY * Math.cos(delta) + hereX * Math.sin(delta) + origin[1]
    ];
    return newPoint;
  }
}

function tValuesForPoints(polylines) {
  let totalLength = 0;
  let lengths = [];
  let tValues = [];
  let segmentLength = 0;
  for (let i = 0; i < polylines.length; i++) {
    let polyline2 = polylines[i];
    for (let j = 0; j < polyline2.length; j++) {
      if (j > 0) {
        let dx = polyline2[j][0] - polyline2[j - 1][0];
        let dy = polyline2[j][1] - polyline2[j - 1][1];
        segmentLength = Math.sqrt(dx * dx + dy * dy);
        totalLength += segmentLength;
      }
      lengths.push(segmentLength);
    }
  }
  let accumulatedLength = 0;
  for (let i = 0; i < lengths.length; i++) {
    accumulatedLength += lengths[i];
    tValues.push(accumulatedLength / totalLength);
  }
  return tValues;
};